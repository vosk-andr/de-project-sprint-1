DDL_create_customer_report_datamart.sql - DDL создания витрины customer_report_datamart.

DDL_load_dates_customer_report_datamart.sql - DDL создания таблицы для инкрементального обновления витрины.

SQL_add_external_source.sql - скрипт создания общей временной таблицы из трех источников для обновления измерений через оператор MERGE.

SQL_update_customer_report_datamart.sql - etl для инкрементального обновления витрины состоящий из следющих этапов СТЕ:
dwh_delta - определяет, какие данные были изменены в витрине или добавлены в DWH по средством сравления дат обновления (load_dttm) таблиц измерений, заказов с датой последней загрузки из таблицы load_dates_customer_report_datamart. Формируем дельту изменений;
  dwh_update_delta - делает выборку покупателей, по которым были изменения в DWH. По этим мастерам дальше будут обновляться данны в витрине;
  dwh_delta_insert_result - делает расчёт витрины по новым данным. Этой информации по мастерам в рамках расчётного периода раньше не было, это новые данные. Их можно просто вставить (insert) в витрину без обновления;
  dwh_delta_update_result - делает перерасчёт для существующих записей витрины, так как данные обновились за отчётные периоды. Логика похожа на insert, но нужно достать конкретные данные из DWH при помощи dwh_update_delta;
  insert_delta - выполняет insert новых расчитанных данных для витрины;
  update_delta - выполняет обновление показателей в отчёте по уже существующим мастерам;
  insert_load_date - делает запись в таблицу загрузок о том, когда была совершена загрузка, чтобы в следующий раз взять данные, которые будут добавлены или изменены после этой даты.
